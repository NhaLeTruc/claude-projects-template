[tool.black]
line-length = 100
target-version = ['py311']
include = '\.pyi?$'
extend-exclude = '''
/(
  | dist
  | .eggs
  | .git
  | build
  | __pycache__
  | .venv
)/
'''

[tool.pytest.ini_options]
minversion = "7.0"
addopts = "-ra -q --strict-markers --cov --cov-report=term-missing --cov-report=html"
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]

[tool.coverage.run]
source = ["."]
omit = [
    "*/tests/*",
    "*/test_*.py",
    "*/__pycache__/*",
    "*/venv/*",
    "*/.venv/*",
]

[tool.coverage.report]
precision = 2
skip_empty = true
fail_under = 80

[tool.mypy]
python_version = "3.11"
# SOLID: Liskov Substitution Principle - strict typing (matches TypeScript no-explicit-any)
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
disallow_any_generics = true
disallow_untyped_calls = true
disallow_incomplete_defs = true
check_untyped_defs = true
disallow_untyped_decorators = true
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
strict_equality = true
ignore_missing_imports = true

# ============ RADON - Cognitive Complexity ============
# Single Responsibility Principle (matches TypeScript sonarjs/cognitive-complexity: 15)
[tool.radon]
cc_min = "A"                  # Minimum grade (A-F, A is best)
cc_max = 15                   # Max cyclomatic complexity (matches TypeScript ESLint)
average = true
show_complexity = true
exclude = "test_*.py,*_test.py,tests/*,venv/*,.venv/*"

# ============ PYDEPS - Circular Dependency Detection ============
# Matches madge.config.json patterns for TypeScript
[tool.pydeps]
max_bacon = 200               # Max module distance to show
cluster = true                # Cluster by package
no_show = false               # Show graph
exclude = [
    "tests",
    "test_*",
    "*_test",
    "__pycache__",
    "venv",
    ".venv",
    "dist",
    "build",
]
reverse = false
verbose = 0

# ============ ISORT - Import Organization ============
# Matches ESLint import/order groups
[tool.isort]
profile = "black"
line_length = 100
sections = ["FUTURE", "STDLIB", "THIRDPARTY", "FIRSTPARTY", "LOCALFOLDER"]
known_first_party = ["src"]
force_single_line = false
force_sort_within_sections = true

# ============ DEPTRY - Full Dependency Health Check ============
# Matches madge comprehensive dependency checking for TypeScript
[tool.deptry]
exclude = [
    "tests",
    "test_.*",
    ".*_test",
    "__pycache__",
    "venv",
    ".venv",
    "dist",
    "build",
    ".eggs",
    ".git",
]

ignore_obsolete = []               # DEP002: Unused deps (add false positives here)
ignore_missing = []                # DEP001: Missing deps (add false positives here)
ignore_transitive = []             # DEP003: Transitive deps
ignore_misplaced_dev = []          # DEP004: Misplaced dev deps

per_rule_ignores = {}

pep621_dev_dependency_groups = ["dev", "test", "docs"]

extend_exclude = [
    "examples/.*",
    "scripts/.*",
]
